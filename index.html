<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>å®¶ä¸­å°ç®¡å®¶ - çå‹µç³»çµ±</title>
    
    <!-- é˜²æ­¢åŠ å…¥ä¸»ç•«é¢å¾Œå‡ºç¾ç™½å±çš„é—œéµæ¨™ç±¤ -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-capable" content="yes">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700;900&display=swap');
        
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: #F8F9FA; 
            color: #3C1E1E; 
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        /* é ‚éƒ¨è§’è‰²é¸å–®ï¼šç½®ä¸­ä¸”åˆ†é–‹ */
        .tab-container { 
            display: flex; justify-content: center; gap: 45px; 
            margin: 30px 0; width: 100%;
        }
        .tab-btn { 
            display: flex; flex-direction: column; align-items: center; 
            cursor: pointer; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            width: 90px;
        }
        
        /* é ­åƒæ¨£å¼ï¼šå¸¶æœ‰è§’è‰²åº•è‰²èˆ‡åœ–ç‰‡ */
        .avatar {
            width: 80px; height: 80px; border-radius: 50%; border: 4px solid white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 8px;
            background-size: cover; background-position: center; background-repeat: no-repeat;
        }
        .ryan-img { background-color: #6DB3FC; background-image: url('https://i.imgur.com/8N4N3u8.png'); }
        .apeach-img { background-color: #FFB6C1; background-image: url('https://i.imgur.com/uI6O4G8.png'); }

        .tab-active { transform: translateY(-10px) scale(1.1); opacity: 1; }
        .tab-active span { font-weight: 900; color: #3C1E1E; font-size: 1rem; }
        .tab-inactive { opacity: 0.4; filter: grayscale(0.2); transform: scale(0.9); }

        /* é»ƒè‰²ç©åˆ†çœ‹æ¿ï¼šå…§å®¹å…¨ç½®ä¸­ã€å¯¬åº¦ç¸®å°ã€ä¸‹æ–¹å¢åŠ é–“è· */
        .boss-board {
            background: linear-gradient(135deg, #FEE500 0%, #FFD200 100%);
            border-radius: 50px; border: 6px solid white;
            box-shadow: 0 12px 24px rgba(254, 229, 0, 0.3);
            width: 88%; margin: 0 auto 55px auto; /* å¯¬åº¦ç¸®å°ä¸”ç½®ä¸­ï¼Œä¸‹æ–¹ç•™ç™½ 55px */
            padding: 30px 20px; text-align: center;
        }

        /* åŠ æ¸›åˆ†è¡Œç‚ºæŒ‰éˆ• */
        .btn-action { @apply text-base font-black active:scale-95 transition-all py-2 cursor-pointer text-center; }

        /* çå‹µå…Œæ›å¡ç‰‡ (é‚„åŸæ¨£å¼) */
        .reward-item {
            background-color: #FFF9F2; border: 2px solid #FEEBC8; border-radius: 30px;
            padding: 16px 20px; margin-bottom: 12px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.03);
        }
        .btn-exchange {
            background-color: #ED8936; color: white; padding: 8px 24px;
            border-radius: 20px; font-weight: 900; font-size: 14px;
            box-shadow: 0 4px 0 #C05621; transition: all 0.1s;
        }
        .btn-exchange:active { transform: translateY(2px); box-shadow: 0 2px 0 #C05621; }
        .btn-locked { background-color: #CBD5E0; box-shadow: 0 4px 0 #A0AEC0; cursor: not-allowed; opacity: 0.7; }

        /* åˆå§‹è¼‰å…¥å‹•ç•«ï¼Œé¿å…ç™½å±æ„Ÿ */
        #app { opacity: 0; transition: opacity 0.5s ease; }
        .loaded #app { opacity: 1; }
    </style>
</head>
<body class="p-4 pb-20">

<div id="app" class="max-w-md mx-auto">
    <!-- éŸ³æ•ˆåº«é€£çµ -->
    <audio id="snd-plus" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3" preload="auto"></audio>
    <audio id="snd-minus" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3" preload="auto"></audio>
    <audio id="snd-exchange" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3" preload="auto"></audio>

    <!-- é ‚éƒ¨é ­åƒåˆ‡æ›å€ -->
    <div class="tab-container">
        <div onclick="switchChild('wei')" id="tab-wei" class="tab-btn">
            <div class="avatar ryan-img"></div>
            <span>ç‘‹ç‘‹</span>
        </div>
        <div onclick="switchChild('hao')" id="tab-hao" class="tab-btn">
            <div class="avatar apeach-img"></div>
            <span>è±ªè±ª</span>
        </div>
    </div>

    <!-- ç´¯ç©åˆ†æ•¸çœ‹æ¿ (å…§å®¹å…¨ç½®ä¸­) -->
    <div class="boss-board">
        <div class="text-[#3C1E1E] opacity-50 text-xs font-black tracking-widest mb-1" id="score-title">ç‘‹ç‘‹ çš„ç´¯ç©åˆ†æ•¸</div>
        <div class="text-6xl font-black tracking-tighter" id="total-score">0</div>
        <div class="flex justify-center mt-4">
            <div class="bg-white/40 px-5 py-1 rounded-full text-[10px] font-black uppercase tracking-widest">
                Level Up Progress
            </div>
        </div>
    </div>

    <!-- åŠ æ¸›åˆ†æ“ä½œ -->
    <div class="flex gap-4 mb-10">
        <div class="flex-1 border-r border-gray-100">
            <h3 class="text-xs font-black text-green-600 mb-5 tracking-widest uppercase text-center">âœ¨ åŠ åˆ†é …ç›®</h3>
            <div id="plus-grid" class="flex flex-col gap-2"></div>
        </div>
        <div class="flex-1">
            <h3 class="text-xs font-black text-red-500 mb-5 tracking-widest uppercase text-center">ğŸ’ª æ‰£åˆ†é …ç›®</h3>
            <div id="minus-grid" class="flex flex-col gap-2"></div>
        </div>
    </div>

    <!-- çå‹µå€ -->
    <div class="px-2 mb-10">
        <h3 class="font-black text-center mb-6 text-[#3C1E1E] flex items-center justify-center gap-2">
            ğŸ çå‹µå…Œæ›
        </h3>
        <div id="reward-stack"></div>
    </div>

    <!-- æ­·å²ç´€éŒ„ -->
    <div class="bg-gray-100/60 rounded-[35px] p-6">
        <h3 class="text-[10px] font-black text-gray-400 mb-3 uppercase tracking-tighter text-center">History Log</h3>
        <div id="history-list" class="space-y-2 max-h-40 overflow-y-auto text-xs"></div>
    </div>
</div>

<script>
const config = {
    wei: {
        name: "ç‘‹ç‘‹", init: 16900,
        actions: [
            { t: "è‰¯å¥½è¡¨ç¾", v: 100 }, { t: "æº–æ™‚æ”¶å¹³æ¿", v: 500 }, { t: "å°è€ƒ > 80", v: 300 },
            { t: "æœŸä¸­æœ«è€ƒ > 80", v: 1000 }, { t: "æœŸä¸­æœ«è€ƒ 70-79", v: 500 },
            { t: "æœªæº–æ™‚å¹³æ¿", v: -300 }, { t: "å«äº†æ²’é¦¬ä¸Šåš", v: -100 },
            { t: "å®¶äº‹æ²’åš", v: -500 }, { t: "ç„¡èŠè¬›å¼Ÿå¼Ÿ", v: -500 },
            { t: "è·Ÿå¼Ÿå¼Ÿåµæ¶", v: -500 }, { t: "åƒé£¯å¤ªä¹…", v: -300 }
        ],
        rewards: [{ t: "300å…ƒç¦®ç‰©", v: 5000 }, { t: "500å…ƒç¦®ç‰©", v: 8000 }, { t: "ç­†è¨˜å‹é›»è…¦", v: 20000 }]
    },
    hao: {
        name: "è±ªè±ª", init: 2150,
        actions: [
            { t: "è‰¯å¥½è¡¨ç¾", v: 100 }, { t: "å‡æ—¥ä¸è®“åª½æ°£", v: 500 }, { t: "å¹³æ—¥ä¸è®“åª½æ°£", v: 250 },
            { t: "æŒ‰æ‘©10åˆ†é˜", v: 100 }, { t: "å°è€ƒ > 85", v: 300 },
            { t: "æœŸä¸­æœ«è€ƒ > 85", v: 1000 }, { t: "è®“åª½å’ªç”Ÿæ°£", v: -100 },
            { t: "è·Ÿå“¥å“¥åµæ¶", v: -500 }, { t: "ç„¡èŠè¬›å“¥å“¥", v: -500 },
            { t: "å®¶äº‹æ²’åš", v: -500 }, { t: "å«äº†æ²’é¦¬ä¸Šåš", v: -100 },
            { t: "å°è€ƒ < 85", v: -200 }, { t: "æœŸä¸­æœ«è€ƒ < 85", v: -500 }
        ],
        rewards: [
            { t: "300å…ƒç¦®ç‰©", v: 5000 }, { t: "500å…ƒç¦®ç‰©", v: 8000 },
            { t: "å»æƒ³å»çš„åœ°æ–¹", v: 9000 }, { t: "è·Ÿåª½å’ªç¡ä¸€é€±", v: 10000 }, { t: "æ™ºæ…§æ‰‹æ©Ÿ", v: 20000 }
        ]
    }
};

let currentID = 'wei';
// å­˜å„²éµåæ›´æ–°ä»¥é¿å…èˆŠæ•¸æ“šå¹²æ“¾
let state = JSON.parse(localStorage.getItem('kakao_v12_final_v2')) || {
    wei: { score: config.wei.init, logs: [] },
    hao: { score: config.hao.init, logs: [] }
};

function playSound(type) {
    const audio = document.getElementById('snd-' + type);
    if (audio) { audio.currentTime = 0; audio.play().catch(e => {}); }
}

function switchChild(id) {
    currentID = id;
    document.getElementById('tab-wei').className = id === 'wei' ? 'tab-btn tab-active' : 'tab-btn tab-inactive';
    document.getElementById('tab-hao').className = id === 'hao' ? 'tab-btn tab-active' : 'tab-btn tab-inactive';
    render();
}

function addPoint(title, value) {
    state[currentID].score += value;
    playSound(value > 0 ? 'plus' : 'minus');
    addLog(title, value);
    save();
}

function exchange(title, cost) {
    if (state[currentID].score < cost) return;
    if (confirm(`ğŸ¦ ç¢ºèªè¦å…Œæ›ã€Œ${title}ã€ä¸¦æ‰£åˆ†å—ï¼Ÿ`)) {
        state[currentID].score -= cost;
        playSound('exchange');
        addLog(`ğŸ å…Œæ›:${title}`, -cost);
        save();
    }
}

function addLog(msg, val) {
    const now = new Date();
    const timeStr = `${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`;
    state[currentID].logs.unshift({ time: timeStr, msg: msg, val: val });
    if (state[currentID].logs.length > 20) state[currentID].logs.pop();
}

function save() {
    localStorage.setItem('kakao_v12_final_v2', JSON.stringify(state));
    render();
}

function render() {
    const data = state[currentID];
    const conf = config[currentID];
    document.getElementById('total-score').innerText = data.score.toLocaleString();
    document.getElementById('score-title').innerText = `${conf.name} çš„ç´¯ç©åˆ†æ•¸`;

    document.getElementById('plus-grid').innerHTML = conf.actions.filter(a => a.v > 0).map(a => `
        <div onclick="addPoint('${a.t}', ${a.v})" class="btn-action text-green-700">
            <span class="font-bold text-[11px] block text-center">${a.t}</span>
            <span class="font-black block text-center">+${a.v}</span>
        </div>
    `).join('');

    document.getElementById('minus-grid').innerHTML = conf.actions.filter(a => a.v < 0).map(a => `
        <div onclick="addPoint('${a.t}', ${a.v})" class="btn-action text-red-500">
            <span class="font-bold text-[11px] block text-center">${a.t}</span>
            <span class="font-black block text-center">${a.v}</span>
        </div>
    `).join('');

    document.getElementById('reward-stack').innerHTML = conf.rewards.map(r => {
        const canBuy = data.score >= r.v;
        return `
            <div class="reward-item">
                <div class="flex flex-col text-left">
                    <span class="font-black text-sm text-[#3C1E1E]">${r.t}</span>
                    <span class="text-[10px] font-bold text-gray-400">${r.v.toLocaleString()} pt</span>
                </div>
                <button onclick="exchange('${r.t}', ${r.v})" class="btn-exchange ${canBuy ? '' : 'btn-locked'}">
                    å…Œæ›
                </button>
            </div>
        `;
    }).join('');

    document.getElementById('history-list').innerHTML = data.logs.map(l => `
        <div class="flex justify-between items-center py-2 border-b border-gray-200/50">
            <span class="text-[10px] text-gray-400 font-mono">${l.time}</span>
            <span class="text-[11px] font-bold text-gray-600">${l.msg}</span>
            <span class="text-[11px] font-black ${l.val > 0 ? 'text-green-500' : 'text-red-400'}">${l.val > 0 ? '+' : ''}${l.val}</span>
        </div>
    `).join('');
}

// ç¢ºä¿ç¶²é è¼‰å…¥å¾Œæ‰å•Ÿå‹•
window.onload = function() {
    document.body.classList.add('loaded');
    switchChild('wei');
};
</script>
</body>
</html>
